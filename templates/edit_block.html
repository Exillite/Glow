{% extends 'base.html' %} {% block content %} {{ super() }}
<div class="steps-view st" id="" id="st">

    {% for s in steps %} {% if s['is_ready'] %}
    <button onclick="gostep({{s['id']}})" class="step active"></button> {% else %}
    <button onclick="gostep({{s['id']}})" class="step notactive"></button> {% endif %} {% endfor %}

    <button onclick="newstep()" class="step notactive">+</button>
</div>

<div id="new_step_menu" class="st new-step-menu">
    <button onclick="clousemenu()" class="exit-new-step-menu">‚úñ</button>
    <div class="btn-new-step-group">
        <div class="new-step-title">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –Ω–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è:</div>
        <br>
        <button onclick="createnewstep('theory')" class="st new-step-type">–¢–µ–æ—Ä–∏—è</button>
        <br>
        <button onclick="createnewstep('short_ans')" class="st new-step-type">–í–≤–æ–¥ –æ—Ç–≤–µ—Ç–∞</button>
        <br>
        <button onclick="createnewstep('long_ans')" class="st new-step-type">–í–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞</button>
        <br>
        <button onclick="createnewstep('task_with_answers')" class="st new-step-type">–¢–µ—Å—Ç</button>
        <br>
        <button onclick="createnewstep('file')" class="st new-step-type">–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª</button>
    </div>
</div>

{% if not steps %}
<form class="context-ex" method="post">

    <div class="step-title">–ó–¥–µ—Å—å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–¥–∞–Ω–∏–π.</div>
    <br>

</form>
{% else %} {% if dt['type'] == 'theory' %}
<form class="context-ex" method="post">
    <input required name="title" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ..." value="{{dt['title']}}" class="step-title">
    <br>
    <textarea required name="text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç..." class="ex-text edit-text">{{dt['text']}}</textarea>

    <button type="submit" class="btn-send-ans">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>

</form>
{% endif %} {% if dt['type'] == 'short_ans' %}
<form class="context-ex" method="post">
    <input required name="title" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ..." value="{{dt['title']}}" class="step-title">
    <br>
    <textarea required name="text" placeholder="–í–≤–µ–¥–∏—Ç–µ —É—Å–ª–æ–≤–∏–µ..." class="ex-text edit-text">{{dt['text']}}</textarea>
    <input required name="correct_answer" value="{{dt['correct_answer']}}" class="ex-input st" id="st" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç...">
    <p></p>
    <button type="submit" class="btn-send-ans">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>

</form>
{% endif %} {% if dt['type'] == 'long_ans' %}
<form class="context-ex" method="post">
    <input required name="title" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ..." value="{{dt['title']}}" class="step-title">
    <br>
    <textarea required name="text" placeholder="–í–≤–µ–¥–∏—Ç–µ —É—Å–ª–æ–≤–∏–µ..." class="ex-text edit-text">{{dt['text']}}</textarea>
    <textarea name="correct_answer" class="ex-input long-input st" id="st" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–µ—Ä–Ω—ã–π –æ—Ç–≤–µ—Ç...">{{dt['correct_answer']}}</textarea>
    <p></p>
    <button type="submit" class="btn-send-ans">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>

</form>
{% endif %} {% if dt['type'] == 'task_with_answers' %}
<form class="context-ex" method="post">
    <input required name="title" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ..." value="{{dt['title']}}" class="step-title">
    <br>
    <textarea required name="text" placeholder="–í–≤–µ–¥–∏—Ç–µ —É—Å–ª–æ–≤–∏–µ..." class="ex-text edit-text">{{dt['text']}}</textarea>

    <p style="font-size: 21px;">–û—Ç–º–µ—Ç—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã.</p>
    <input type="checkbox" style="font-size: 32px;"> –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω –≤–µ—Ä–Ω—ã–π –æ—Ç–µ—Ç. <br>
    <div class="ans-list" id="ans_edit_list">
        <p class="radio-ans"><label>–î–æ–±–∞–≤—Ç–µ –æ—Ç–≤–µ—Ç: <input style="height: 30px; width: 65%; font-size: 21px;" id="new_ans_edit" type="text"><button type="button" onclick="addanstolist()" style="height: 30px; width: 30px; font-size: 22px;">+</button></label></p>


        {% for a in dt['answers'] %} {% if a != '' %}
        <p class="radio-ans"><label><input class="radio-btn" name="{{a}}" type="checkbox" value="nedzen"> {{a}}</label></p>
        {% endif %} {% endfor %}

    </div>
    <p></p>
    <button type="submit" class="btn-send-ans">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>

</form>
{% endif %} {% if dt['type'] == 'file' %}
<form class="context-ex" method="post">
    <input required name="title" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ..." value="{{dt['title']}}" class="step-title">
    <br>
    <textarea required name="text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç..." class="ex-text edit-text">{{dt['text']}}</textarea>

    <div class="file-apload-area">
        <div class="st apload-img">ü°Ö</div>
        <input required name="file" type="file" class="st apload-bt-edit">
    </div>

    <button type="submit" class="btn-send-ans">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>

</form>
{% endif %} {% endif %}


<script>
    var stpv = document.getElementsByClassName('st');
    for (const el of stpv) {
        el.style = "left: calc(50% - " + el.offsetWidth + "px / 2);";
    }

    function gostep(id) {
        var st = document.location.href;
        document.location.href = st.slice(0, st.lastIndexOf('/')) + "/" + id;
    }

    var new_step_menu = document.getElementById('new_step_menu');
    new_step_menu.hidden = true;

    function newstep() {
        var stl = document.getElementById('');
        console.log();
        new_step_menu.hidden = false;
    }

    function clousemenu() {
        new_step_menu.hidden = true;
    }

    function addanstolist() {
        var ansst = document.getElementById('new_ans_edit');
        var ansls = document.getElementById('ans_edit_list');

        if (ansst.value === '') {
            return;
        }

        let newans = document.createElement('p');
        newans.className = 'radio-ans';
        newans.innerHTML = '<label><input class="radio-btn" name="answer" type="checkbox" value="nedzen"> ' + ansst.value + '</label>';

        ansls.appendChild(newans);

        let xhr = new XMLHttpRequest();
        // –∞–¥—Ä–µ—Å, –∫—É–¥–∞ –º—ã –æ—Ç–ø—Ä–∞–≤–∏–º –Ω–∞—à—É JSON-—Å—Ç—Ä–æ–∫—É
        let url = myip + "/api";
        // –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
        xhr.open("POST", url, true);
        // —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ ‚Äî –≤—ã–±–∏—Ä–∞–µ–º —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –º—ã —è–≤–Ω–æ –ø–∏—à–µ–º, —á—Ç–æ —ç—Ç–æ JSON
        xhr.setRequestHeader("Content-Type", "application/json");
        // –∫–æ–≥–¥–∞ –ø—Ä–∏–¥—ë—Ç –æ—Ç–≤–µ—Ç –Ω–∞ –Ω–∞—à–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É, –º—ã –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–µ–º –∑–¥–µ—Å—å
        xhr.onreadystatechange = function() {
            // –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –ø—Ä–∏–Ω—è—Ç –∏ —Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—Ç–∏–ª, —á—Ç–æ –≤—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ
            if (xhr.readyState === 4 && xhr.status === 200) {
                // –≤—ã–≤–æ–¥–∏–º —Ç–æ, —á—Ç–æ –æ—Ç–≤–µ—Ç–∏–ª –Ω–∞–º —Å–µ—Ä–≤–µ—Ä ‚Äî —Ç–∞–∫ –º—ã —É–±–µ–¥–∏–º—Å—è, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ–Ω –ø–æ–ª—É—á–∏–ª –ø—Ä–∞–≤–∏–ª—å–Ω–æ
                ansst.value = '';
            }
        };
        // –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ JSON –≤ —Å—Ç—Ä–æ–∫—É
        var data = JSON.stringify({
            "method": "add_new_ans_in_step",
            'step_id': document.location.pathname.split('/')[4] * 1,
            'ans': ansst.value
        });
        // –∫–æ–≥–¥–∞ –≤—Å—ë –≥–æ—Ç–æ–≤–æ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º JSON –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        xhr.send(data);
    }

    function createnewstep(str) {
        let xhr = new XMLHttpRequest();
        // –∞–¥—Ä–µ—Å, –∫—É–¥–∞ –º—ã –æ—Ç–ø—Ä–∞–≤–∏–º –Ω–∞—à—É JSON-—Å—Ç—Ä–æ–∫—É
        let url = myip + "/api";
        // –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
        xhr.open("POST", url, true);
        // —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ ‚Äî –≤—ã–±–∏—Ä–∞–µ–º —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –º—ã —è–≤–Ω–æ –ø–∏—à–µ–º, —á—Ç–æ —ç—Ç–æ JSON
        xhr.setRequestHeader("Content-Type", "application/json");
        // –∫–æ–≥–¥–∞ –ø—Ä–∏–¥—ë—Ç –æ—Ç–≤–µ—Ç –Ω–∞ –Ω–∞—à–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É, –º—ã –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–µ–º –∑–¥–µ—Å—å
        xhr.onreadystatechange = function() {
            // –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –ø—Ä–∏–Ω—è—Ç –∏ —Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—Ç–∏–ª, —á—Ç–æ –≤—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ
            if (xhr.readyState === 4 && xhr.status === 200) {
                // –≤—ã–≤–æ–¥–∏–º —Ç–æ, —á—Ç–æ –æ—Ç–≤–µ—Ç–∏–ª –Ω–∞–º —Å–µ—Ä–≤–µ—Ä ‚Äî —Ç–∞–∫ –º—ã —É–±–µ–¥–∏–º—Å—è, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ–Ω –ø–æ–ª—É—á–∏–ª –ø—Ä–∞–≤–∏–ª—å–Ω–æ
                location.reload();
            }
        };
        // –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ JSON –≤ —Å—Ç—Ä–æ–∫—É
        var data = JSON.stringify({
            "method": "make_step",
            'module_id': document.location.pathname.split('/')[3] * 1,
            'type': str
        });
        // –∫–æ–≥–¥–∞ –≤—Å—ë –≥–æ—Ç–æ–≤–æ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º JSON –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        xhr.send(data);
    }
</script>

{%endblock %}